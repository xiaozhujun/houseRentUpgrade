<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="css/base.css">
    <link rel="stylesheet" type="text/css" href="css/common.css">
    <link rel="stylesheet" type="text/css" href="css/releaseInfo.css">
	<link href="/css/jquery/jquery-ui-1.10.3.custom.min.css" type="text/css" rel="stylesheet">
</head>
<body>
<div id="topbar" class="topbar"></div>

<div id="headerNoSearch" class="header mb10"></div>


<div class="releaseMain">
    <h1>填写房源信息</h1>
        <table class="releaseTable">
            <tbody>
                <tr>
                    <th>
                        <em class="red">*</em>出租类型
                    </th>
                    <td>
                        <label class="mr15" for="HireType1">
                            <input id="HireType1" type="radio" value="1" name="rentType">
                            整套出租
                        </label>
                        <label class="mr15" for="HireType2">
                            <input id="HireType2" type="radio" value="2" name="rentType">
                            单间出租
                        </label>
                        <label for="HireType3">
                            <input id="HireType3" type="radio" value="3" name="rentType">
                            床位出租
                        </label>
                    </td>
                </tr>

                <tr>
                    <th>
                        <em class="red">*</em>成交方式
                    </th>
                    <td>
                        <label class="mr15" for="free">
                            <input id="free" type="radio" value="1" name="moneyType">
                            无偿出租
                        </label>
                        <label class="mr15" for="money">
                            <input id="money" type="radio" value="2" name="moneyType">
                            有偿出租
                        </label>
                    </td>
                </tr>

                <tr>
                    <th>
                        <em class="red">*</em>小区名称
                    </th>
                    <td>
                        <input id="community" class="txt" type="text" maxlength="30" value="" style="width:300px;">
                    </td>
                </tr>
                
                 <tr>
                    <th>
                        <em class="red">*</em>街道名称
                    </th>
                    <td>
                        <input id="street" class="txt" type="text" maxlength="30" value="" style="width:300px;">
                    </td>
                </tr>

                <tr>
                    <th>
                        <em class="red">*</em>房屋户型
                    <td>
                        <input id="room" class="txt w30" type="text" maxlength="1" value="" name="jushishuru">
                        <span class="ml5 mr5">室</span>
                        <input id="parlor" class="txt w30 action_color" type="text" maxlength="1"
                        except="null" value="" name="huxingting">
                        <span class="ml5 mr5">厅</span>
                        <input id="washroom" class="txt w30 action_color" type="text" maxlength="1"
                        except="null" value="" name="huxingwei">
                        <span class="ml5 mr5">卫</span>
                        <input id="area" class="txt w30 ml10" type="text" maxlength="4" except="null"
                        value="" name="area">
                        <span class="ml5 mr10">㎡</span>
                    </td>
                </tr>
                
                 <tr>
                    <th>
                        <em class="red">*</em>可出租时间
                    </th>
                    <td>
                        <input id="transferTime" class="txt" type="text" maxlength="30" value="" style="width:300px;">
                    </td>
                </tr>

                <tr>
                    <th>
                        <em class="red">*</em>租金
                    </th>
                    <td>
                        <input id="price" class="txt w70" type="text" maxlength="6" value="面议" name="MinPrice">
                        <span class="ml5 mr10">元/月</span>
                        <select name="fukuanfangshi" id="fukuanfangshi">
                            <option value="0">押一付一</option>
                            <option value="1">押一付二</option>
                            <option value="2">押一付三</option>
                            <option value="3">半年付</option>
                            <option value="4">年付</option>
                        </select>
                    </td>
                </tr>

                <tr>
                    <th>
                        <em class="red">*</em>标题
                    </th>
                    <td>
                        <input id="title" class="txt w500" type="text" maxlength="30" value="">
                    </td>
                </tr>

                <tr>
                    <th>
                        <em class="red">*</em>房源描述
                    </th>
                    <td>
                        <textarea id="detail_description" class="w500 h150"></textarea>
                    </td>
                </tr>
                
                 <tr id="imgUploadShowTR" style="display:none;">
                    <th>
                        <em class="red">*</em>已上传图片
                    </th>
                    <td>
                        <div id="imgUploadList"></div>
                    </td>
                </tr>

                <tr>
                    <th>
                        <em class="red">*</em>上传图片
                    </th>
                    <td>
<!--                         <input type="file" id="tupianshangchuan"> -->
                        <form id="imgUpladForm" method="post" action="/House/upload">
							<div class='rowDiv'>
						  		<div  class='inputDiv'>
						  			<input type="file" name="myfile">
							        <input type="submit" value="上传照片">
								</div>
							</div>
							<div class="rowDiv">
							  	<div class='inputDiv'>
							  		<div class="progress">
								        <div class="bar"></div >
								        <div class="percent">0%</div >
						  			</div>
							    </div>
							</div>
						
						</form>
                    </td>
                </tr>

                <tr>
                    <th>
                        <em class="red">*</em>联系人
                    </th>
                    <td>
                        <input id="contact_person" class="txt w150" type="text" maxlength="30" value="">
                    </td>
                </tr>

                <tr>
                    <th>
                        <em class="red">*</em>联系电话
                    </th>
                    <td>
                        <input id="contact_phone" class="txt w150" type="text" maxlength="30" value="">
                    </td>
                </tr>

                <tr>
                    <th></th>
                    <td>
                        <span class="fabubtn1 mt20">
                            <input id="publishHouseBtn" class="fabu1" type="submit" value="确定并发布">
                        </span>
                    </td>
                </tr>
            </tbody>
        </table>
</div>


<div id="footer" class="footer">尾部</div>
<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="/js/config.js"></script>
<script type="text/javascript" src="js/common.js"></script>
<script type="text/javascript" src="js/releaseInfo.js"></script>
<script src="/js/jquery-ui-1.10.3.custom.min.js" type="text/javascript"></script>
<script src="/js/jquery.form.js" type="text/javascript"></script>

<script type="text/javascript">

function showUploadImg(data)
{
	var newImg = $("<img class='uploadedImg' height=150/>").attr("src",data.fileUrl);
	$("#imgUploadList").append(newImg).append("&nbsp;");
}

$(document).ready(function(){
	
	var bar = $('.bar');
	var percent = $('.percent');
	var status = $('#status');
	   
	$('#imgUpladForm').ajaxForm({
		dataType:"json",
	    beforeSend: function() {
	        status.empty();
	        var percentVal = '0%';
	        bar.width(percentVal)
	        percent.html(percentVal);
	    },
	    uploadProgress: function(event, position, total, percentComplete) {
	        var percentVal = percentComplete + '%';
	        bar.width(percentVal)
	        percent.html(percentVal);
	    },
	    success: function() {
	        var percentVal = '100%';
	        bar.width(percentVal)
	        percent.html(percentVal);
	    },
		complete: function(xhr) {
			$("#imgUploadShowTR").show();
			showUploadImg($.parseJSON(xhr.responseText));
		}
	}); 
				
		$('#publishHouseBtn').click(function(){
			if(checkform()){
				var data = {};
				data.title = $('#title').val();
				data.price = $('#price').val();
				data.transferTime = $('#transferTime').val();
				data.room = $('#room').val();
				data.parlor = $('#parlor').val();
				data.washroom = $('#washroom').val();
				
				data.rentType=$("input[name='rentType']:checked").val();
				data.moneyType=$("input[name='moneyType']:checked").val();
				data.region = $('#region').val();
				data.area = $('#area').val();
				data.street = $('#street').val();
				data.community = $('#community').val();
				data.contactPerson = $('#contact_person').val();
				data.contactPhone = $('#contact_phone').val();
				data.detailDescription = $('#detail_description').val();
				$.post($.URL.house.publishhouse,data,callback,"json");
			}

		});
		
	$("#transferTime").datepicker({    //  记得要括在大括号之内
        dateFormat:"yy-mm-dd",  //设置日期格式
        changeMonth:true,   //是否提供月份选择
        changeYear:true,    //是否提供年份选择
        dayNamesMin: ['日','一','二','三','四','五','六'],  //日期简写名称
        monthNamesShort: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月']  //月份简写名称
    });

});

function callback(result){
	if(result.code==0){
		alert("房源发布成功！");
	}else if(result.code==-1){
		alert("请先登陆！");
		location="/login.html";
	}else{
		alert("房源发布失败！");
	}
}
function checkdigital(param){
if(/\d/.test(param.value)){
	return;
}else{
	alert("请输入数字！");
	param.value='';
}
}
function checkform(){
if($('#title').val()==""){
	alert("请输入标题！");
	$("#title").focus();
	return false;
}
if($('#room').val()==""&&$('#parlor').val()==""&&$('#washroom').val()==""){
	alert("请正确输入房屋类型！");
	$('#room').focus();
	return false;
}
if($('#price').val==""){
	alert("请输入价格！");
	$('#price').focus();
	return false;
}
if($('#area').val==""){
	alert("请输入房屋面积！");
	$('#area').focus();
	return false;
}
if($('#address_info').val==""){
	alert("请输入详细地址！");
	$('#address_info').focus();
	return false;
}
if($('#contact_person').val==""){
	alert("请输入联系人！");
	$('#contact_person').focus();
	return false;
}
if($('#contact_phone').val==""){
	alert("请输入联系人电话！");
	$('#contact_phone').focus();
	return false;
}
if($('#contact_email').val==""){
	alert("请输入联系人邮箱！");
	$('#contact_email').focus();
	return false;
}
return true;
}
</script>
</body>
</html>